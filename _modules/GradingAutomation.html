

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GradingAutomation &mdash; GradingAutomation 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GradingAutomation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#using-conda-environment">Using Conda Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#using-python-requirements-file">Using Python Requirements File</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using_application.html">Using the Application ( Manual )</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using_application.html#start-the-application-using-one-of-these-methods">Start the application using one of these methods:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_application.html#configure-the-application">Configure the application:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_application.html#download-student-submissions-and-verify-projects-in-project-verification-tab">Download student submissions and verify projects in “Project Verification” Tab:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_application.html#create-canvas-pages-from-group-folders-on-page-management-tab">Create Canvas Pages from group folders on “Page Management” Tab:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_application.html#adding-forms-and-quizzes-and-grading-responses-on-form-and-quizzes-tab">Adding Forms and Quizzes and Grading Responses on “Form and Quizzes” Tab:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_application.html#analyze-form-responses-in-form-analysis-tab">Analyze Form Responses in “Form Analysis” Tab.</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setting_up_canvas_access_token.html">Setting up Canvas Access Token</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setting_up_google_api.html">Setting up Google API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">canvas_automation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Architecture.html">Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Architecture.html#overview-of-the-canvas-automation-system">Overview of the Canvas Automation System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Architecture.html#pipelines">Pipelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../GradingAutomation.html">GradingAutomation module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../GradingAutomation.html#GradingAutomation.Grader"><code class="docutils literal notranslate"><span class="pre">Grader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../GradingAutomation.html#GradingAutomation.apply_iqr"><code class="docutils literal notranslate"><span class="pre">apply_iqr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../GradingAutomation.html#GradingAutomation.create_image"><code class="docutils literal notranslate"><span class="pre">create_image()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../GradingAutomation.html#GradingAutomation.read_json_file"><code class="docutils literal notranslate"><span class="pre">read_json_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../GradingAutomation.html#GradingAutomation.read_yml_file"><code class="docutils literal notranslate"><span class="pre">read_yml_file()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../GradingAutomationUI.html">GradingAutomationUI module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CanvasServices.html">Canvas API Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../CanvasServices.html#module-Canvas.CanvasService">Canvas Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CanvasServices.html#module-Canvas.schemas">Canvas Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CanvasServices.html#module-Canvas.test_canvas_service">Canvas Tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../GoogleServices.html">GoogleService module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../GoogleServices.html#GoogleServices.GoogleServices.GoogleServicesManager"><code class="docutils literal notranslate"><span class="pre">GoogleServicesManager</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../GoogleServices.html#GoogleServices.GoogleServices.get_id_from_url"><code class="docutils literal notranslate"><span class="pre">get_id_from_url()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../GoogleServices.html#module-GoogleServices.schemas">GoogleService Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GoogleServices.html#googleservice-tests">GoogleService Tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Logging.html">Logging module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Logging.html#Logging.LogLevel"><code class="docutils literal notranslate"><span class="pre">LogLevel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Logging.html#Logging.Print"><code class="docutils literal notranslate"><span class="pre">Print()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Logging.html#Logging.set_log_level"><code class="docutils literal notranslate"><span class="pre">set_log_level()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../schemas.html">schemas module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../schemas.html#schemas.ClassInfoSchema"><code class="docutils literal notranslate"><span class="pre">ClassInfoSchema</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../schemas.html#schemas.PresentationTime"><code class="docutils literal notranslate"><span class="pre">PresentationTime</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../schemas.html#schemas.StudentRecord"><code class="docutils literal notranslate"><span class="pre">StudentRecord</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../schemas.html#schemas.TeamInfo"><code class="docutils literal notranslate"><span class="pre">TeamInfo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../schemas.html#schemas.TeamMember"><code class="docutils literal notranslate"><span class="pre">TeamMember</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GradingAutomation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">GradingAutomation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for GradingAutomation</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">from</span> <span class="nn">Canvas.CanvasService</span> <span class="kn">import</span> <span class="n">CanvasAPI</span>
<span class="kn">from</span> <span class="nn">Canvas.schemas</span> <span class="kn">import</span> <span class="n">PageSchema</span><span class="p">,</span> <span class="n">QuizSchema</span>
<span class="kn">from</span> <span class="nn">GoogleServices.GoogleServices</span> <span class="kn">import</span> <span class="n">GoogleServicesManager</span>
<span class="kn">from</span> <span class="nn">Logging</span> <span class="kn">import</span> <span class="n">Print</span>
<span class="kn">from</span> <span class="nn">schemas</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">gspread.worksheet</span> <span class="kn">import</span> <span class="n">Worksheet</span>


<div class="viewcode-block" id="read_json_file">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.read_json_file">[docs]</a>
<span class="k">def</span> <span class="nf">read_json_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a JSON file and return its contents as a dictionary&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">),</span> <span class="s2">&quot;File must be a JSON file&quot;</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;File does not exist, </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>



<div class="viewcode-block" id="read_yml_file">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.read_yml_file">[docs]</a>
<span class="k">def</span> <span class="nf">read_yml_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a YAML file and return its contents as a dictionary&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yml&quot;</span><span class="p">),</span> <span class="s2">&quot;File must be a YAML file&quot;</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="s2">&quot;File does not exist, YML&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>



<div class="viewcode-block" id="create_image">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.create_image">[docs]</a>
<span class="k">def</span> <span class="nf">create_image</span><span class="p">(</span><span class="n">responses</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes a DataFrame of responses and an output path to save the generated image.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        responses (pd.DataFrame): DataFrame containing student data</span>
<span class="sd">        output_path (str): Path where the image will be saved</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; responses = pd.DataFrame({</span>
<span class="sd">        ...     &#39;Student&#39;: [&#39;Alice&#39;, &#39;Bob&#39;, &#39;Charlie&#39;],</span>
<span class="sd">        ...     &#39;Score&#39;: [85, 90, 78]</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; output_path = &#39;output/grades_chart.png&#39;</span>
<span class="sd">        &gt;&gt;&gt; create_image(responses, output_path)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
        <span class="n">responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Slide deck?&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogram of Overall Grades Slide deck&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Overall Slide deck Grade&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="c1"># Overall grade to this team&#39;s Research topic and (summary) paper content?</span>
    <span class="c1"># Overall grade to this team&#39;s Presentation skills?</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
        <span class="n">responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Presentation skills?&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span>
        <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogram of Presentation Skills Grades&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Presentation Skills Grade&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
        <span class="n">responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Research topic and (summary) paper content?&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span>
        <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogram of Research Topic and Paper Content Grades&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Research Topic and Paper Content Grade&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span></div>



<div class="viewcode-block" id="apply_iqr">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.apply_iqr">[docs]</a>
<span class="k">def</span> <span class="nf">apply_iqr</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">return_outliers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identifies student outliers using the IQR method&quot;&quot;&quot;</span>

    <span class="c1"># Calculate Q1, Q3, IQR, lower and upper whiskers</span>
    <span class="n">Q1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>  <span class="c1"># 25th percentile</span>
    <span class="n">Q3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>  <span class="c1"># 75th percentile</span>
    <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
    <span class="n">lower_whisker</span> <span class="o">=</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
    <span class="n">upper_whisker</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>

    <span class="n">outliers</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">lower_whisker</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">upper_whisker</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">lower_whisker</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">upper_whisker</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">filtered_data</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">return_outliers</span> <span class="k">else</span> <span class="n">outliers</span></div>



<div class="viewcode-block" id="Grader">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader">[docs]</a>
<span class="k">class</span> <span class="nc">Grader</span><span class="p">:</span>
    <span class="n">SPREADSHEET_COLUMN_NAMES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;Email&quot;</span><span class="p">,</span>
        <span class="s2">&quot;team_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Team_Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;slide_deck&quot;</span><span class="p">:</span> <span class="s2">&quot;Overall grade to this team&#39;s Slide deck?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;presentation_skills&quot;</span><span class="p">:</span> <span class="s2">&quot;Overall grade to this team&#39;s Presentation skills?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;research_topic&quot;</span><span class="p">:</span> <span class="s2">&quot;Overall grade to this team&#39;s Research topic and (summary) paper content?&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">course_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">module_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">api_token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">CanvasAPI</span><span class="p">(</span><span class="n">course_id</span><span class="o">=</span><span class="n">course_id</span><span class="p">,</span> <span class="n">api_token</span><span class="o">=</span><span class="n">api_token</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">google</span> <span class="o">=</span> <span class="n">GoogleServicesManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module_id_with_presentations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_module_by_title</span><span class="p">(</span><span class="n">module_title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">student_records</span><span class="p">:</span> <span class="n">StudentRecords</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">:</span> <span class="n">Worksheet</span>

<div class="viewcode-block" id="Grader.set_worksheet">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.set_worksheet">[docs]</a>
    <span class="k">def</span> <span class="nf">set_worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">worksheet_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">open_spreadsheet_by_id</span><span class="p">(</span><span class="n">sheet_id</span><span class="p">)</span><span class="o">.</span><span class="n">get_worksheet</span><span class="p">(</span><span class="n">worksheet_index</span><span class="p">)</span></div>


<div class="viewcode-block" id="Grader.read_worksheet">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.read_worksheet">[docs]</a>
    <span class="k">def</span> <span class="nf">read_worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StudentRecords</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">student_records</span><span class="p">:</span> <span class="n">StudentRecords</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">worksheet_records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">read_worksheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">worksheet_records</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">student_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StudentRecord</span><span class="p">(</span><span class="o">**</span><span class="n">record</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">student_records</span></div>


<div class="viewcode-block" id="Grader.update_worksheet">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.update_worksheet">[docs]</a>
    <span class="k">def</span> <span class="nf">update_worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">update_worksheet_from_records</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">student_records</span><span class="p">)</span>  <span class="c1"># type: ignore</span></div>


<div class="viewcode-block" id="Grader.convert_student_record_sheets_to_team_info">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.convert_student_record_sheets_to_team_info">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_student_record_sheets_to_team_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Team_Name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TeamInfo</span><span class="p">:</span>
        <span class="c1"># get the team that has the project_path</span>
        <span class="n">team_record</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">student_records</span> <span class="k">if</span> <span class="n">record</span><span class="p">[</span><span class="s2">&quot;Team_Name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Team_Name</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">team_record</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Team info not found for team: </span><span class="si">{</span><span class="n">Team_Name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">team_name</span> <span class="o">=</span> <span class="n">team_record</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;Team_Name&quot;</span><span class="p">]</span>
        <span class="n">topic</span> <span class="o">=</span> <span class="n">team_record</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;Topic&quot;</span><span class="p">]</span>
        <span class="n">team_members</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">TeamMember</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># name and email</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">team_record</span><span class="p">:</span>
            <span class="n">team_members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TeamMember</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">record</span><span class="p">[</span><span class="s2">&quot;Names&quot;</span><span class="p">],</span> <span class="n">email</span><span class="o">=</span><span class="n">record</span><span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">TeamInfo</span><span class="p">(</span>
            <span class="n">team_name</span><span class="o">=</span><span class="n">team_name</span><span class="p">,</span>
            <span class="n">topic</span><span class="o">=</span><span class="n">topic</span><span class="p">,</span>
            <span class="n">team_members</span><span class="o">=</span><span class="n">team_members</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Grader.convert_team_info_to_student_record">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.convert_team_info_to_student_record">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_team_info_to_student_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_info</span><span class="p">:</span> <span class="n">TeamInfo</span><span class="p">,</span> <span class="n">Team_Name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StudentRecord</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;TODO: Don&#39;t know if is necessary - Not fully implemented&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StudentRecord</span><span class="p">(</span><span class="n">Team_Name</span><span class="o">=</span><span class="n">team_info</span><span class="o">.</span><span class="n">team_name</span><span class="p">,</span> <span class="n">Topic</span><span class="o">=</span><span class="n">team_info</span><span class="o">.</span><span class="n">topic</span><span class="p">,</span> <span class="o">**</span><span class="n">team_info</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span></div>


<div class="viewcode-block" id="Grader.is_a_project_folder">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.is_a_project_folder">[docs]</a>
    <span class="k">def</span> <span class="nf">is_a_project_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="ow">and</span> <span class="s2">&quot;paper.pdf&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;presentation.pdf&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;presentation.pptx&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="ow">and</span> <span class="s2">&quot;github.txt&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Grader.get_folders_with_team">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.get_folders_with_team">[docs]</a>
    <span class="k">def</span> <span class="nf">get_folders_with_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1"># Get the folders that contain the team_info.yml file</span>
        <span class="n">folders</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_a_project_folder</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
                <span class="n">folders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="c1"># Print(&quot;folders = &quot;, folders)</span>
        <span class="k">return</span> <span class="n">folders</span></div>


<div class="viewcode-block" id="Grader.set_module_id_with_presentations">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.set_module_id_with_presentations">[docs]</a>
    <span class="k">def</span> <span class="nf">set_module_id_with_presentations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module_id_with_presentations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_module_by_title</span><span class="p">(</span><span class="n">module_title</span><span class="p">)</span></div>


<div class="viewcode-block" id="Grader.get_pages_to_create">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.get_pages_to_create">[docs]</a>
    <span class="k">def</span> <span class="nf">get_pages_to_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of folders that do not have a Canvas pages in the presentations module.</span>

<span class="sd">        This method checks each folder against existing Canvas pages to determine which folders</span>
<span class="sd">        need new pages created. It uses the team name from the folder path to match against</span>
<span class="sd">        Canvas page titles.</span>

<span class="sd">        Args:</span>
<span class="sd">            folders: List of folder paths to check for existing Canvas pages.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: List of folder paths that need Canvas pages created.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; grader = Grader(...)</span>
<span class="sd">            &gt;&gt;&gt; folders = [&#39;/path/to/team1&#39;, &#39;/path/to/team2&#39;]</span>
<span class="sd">            &gt;&gt;&gt; pages_to_create = grader.get_pages_to_create(folders)</span>
<span class="sd">            &gt;&gt;&gt; print(pages_to_create)</span>
<span class="sd">            [&#39;/path/to/team2&#39;]  # Only team2 needs a page created</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the pages in the module</span>
        <span class="n">pages_created</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">list_module_items</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module_id_with_presentations</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;pages already created = &quot;</span><span class="p">,</span> <span class="n">pages_created</span><span class="p">)</span>
        <span class="n">pages_to_create</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
            <span class="n">team_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
            <span class="c1"># Check if the page already exists</span>
            <span class="n">page_exists</span> <span class="o">=</span> <span class="nb">any</span><span class="p">([</span><span class="n">team_name</span> <span class="o">==</span> <span class="n">page</span><span class="o">.</span><span class="n">title</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages_created</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">page_exists</span><span class="p">:</span>
                <span class="n">pages_to_create</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
        <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;pages to create = &quot;</span><span class="p">,</span> <span class="n">pages_to_create</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pages_to_create</span></div>


<div class="viewcode-block" id="Grader.get_assignment_id_by_title">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.get_assignment_id_by_title">[docs]</a>
    <span class="k">def</span> <span class="nf">get_assignment_id_by_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assignment_title</span><span class="p">):</span>
        <span class="n">assignment_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_assignment_by_title</span><span class="p">(</span><span class="n">assignment_title</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">assignment_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find assignment id with assignment title.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">assignment_id</span></div>


<div class="viewcode-block" id="Grader.get_spreadsheet_by_id">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.get_spreadsheet_by_id">[docs]</a>
    <span class="k">def</span> <span class="nf">get_spreadsheet_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spreadsheet_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">spreadsheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">open_spreadsheet_by_id</span><span class="p">(</span><span class="n">spreadsheet_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">spreadsheet</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find spreadsheet with id&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">spreadsheet</span></div>


<div class="viewcode-block" id="Grader.get_google_form_responses">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.get_google_form_responses">[docs]</a>
    <span class="k">def</span> <span class="nf">get_google_form_responses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form_id</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">get_form_responses</span><span class="p">(</span><span class="n">form_id</span><span class="p">)</span>  <span class="c1"># DataFrame</span>
        <span class="k">if</span> <span class="n">responses</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No responses found in Google Form.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">responses</span></div>


<div class="viewcode-block" id="Grader.load_data_from_spreadsheet">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.load_data_from_spreadsheet">[docs]</a>
    <span class="k">def</span> <span class="nf">load_data_from_spreadsheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spreadsheet_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads form responses using column names&quot;&quot;&quot;</span>

        <span class="c1"># Will need to adjust for actual column names</span>
        <span class="n">columns_to_read</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;slide_deck&quot;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;presentation_skills&quot;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;research_topic&quot;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;team_name&quot;</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">columns_to_read</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error: The file is empty or the columns do not match.&quot;</span><span class="p">)</span>

        <span class="c1"># Normalize email addresses to lowercase</span>
        <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="Grader.calculate_group_averages">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.calculate_group_averages">[docs]</a>
    <span class="k">def</span> <span class="nf">calculate_group_averages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the average grade for each team on their slide deck, presentation skills, and research topic and paper content&quot;&quot;&quot;</span>

        <span class="c1"># Group by &#39;Team&#39; and calculate average for each grade category</span>
        <span class="n">group_avg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;team_name&quot;</span><span class="p">])</span>
            <span class="o">.</span><span class="n">agg</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;slide_deck&quot;</span><span class="p">]:</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;presentation_skills&quot;</span><span class="p">]:</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;research_topic&quot;</span><span class="p">]:</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">group_avg</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;slide_deck&quot;</span><span class="p">]:</span> <span class="s2">&quot;Average Slide Deck Grade&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;presentation_skills&quot;</span><span class="p">]:</span> <span class="s2">&quot;Average Presentation Skills Grade&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;research_topic&quot;</span><span class="p">]:</span> <span class="s2">&quot;Average Research and Topic Grade&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Drop rows with any NaN values</span>
        <span class="n">group_avg</span> <span class="o">=</span> <span class="n">group_avg</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">group_avg</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">group_avg</span></div>


<div class="viewcode-block" id="Grader.calculate_student_averages">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.calculate_student_averages">[docs]</a>
    <span class="k">def</span> <span class="nf">calculate_student_averages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the averages students gave for each team based on each category&quot;&quot;&quot;</span>
        <span class="n">student_avg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">])</span>
            <span class="o">.</span><span class="n">agg</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;slide_deck&quot;</span><span class="p">]:</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;presentation_skills&quot;</span><span class="p">]:</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;research_topic&quot;</span><span class="p">]:</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">student_avg</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;slide_deck&quot;</span><span class="p">]:</span> <span class="s2">&quot;Average grade given for Slide decks&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;presentation_skills&quot;</span><span class="p">]:</span> <span class="s2">&quot;Average grade given for Presentation skills&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span>
                    <span class="s2">&quot;research_topic&quot;</span>
                <span class="p">]:</span> <span class="s2">&quot;Average grade given for Research topic and (summary) paper content&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">student_avg</span></div>


<div class="viewcode-block" id="Grader.get_top_three_presentations">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.get_top_three_presentations">[docs]</a>
    <span class="k">def</span> <span class="nf">get_top_three_presentations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_averages</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="c1"># Calculate the overall average grade for each team</span>
        <span class="n">group_averages</span><span class="p">[</span><span class="s2">&quot;Overall Average Grade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_averages</span><span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;Average Slide Deck Grade&quot;</span><span class="p">,</span> <span class="s2">&quot;Average Presentation Skills Grade&quot;</span><span class="p">,</span> <span class="s2">&quot;Average Research and Topic Grade&quot;</span><span class="p">]</span>
        <span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Sort by the Overall Average Grade (descending order)</span>
        <span class="n">top_3</span> <span class="o">=</span> <span class="n">group_averages</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Overall Average Grade&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">top_3</span></div>


<div class="viewcode-block" id="Grader.get_student_outliers">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.get_student_outliers">[docs]</a>
    <span class="k">def</span> <span class="nf">get_student_outliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identifies students who provided outlier grades or zeros, and counts the number for each student.&quot;&quot;&quot;</span>

        <span class="n">outliers_count</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Dictionary to store email and count of outliers/zeros</span>

        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;slide_deck&quot;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;presentation_skills&quot;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SPREADSHEET_COLUMN_NAMES</span><span class="p">[</span><span class="s2">&quot;research_topic&quot;</span><span class="p">],</span>
        <span class="p">]:</span>
            <span class="c1"># Identify outliers and zeros in the category</span>
            <span class="n">outliers</span> <span class="o">=</span> <span class="n">apply_iqr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">outliers</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="c1"># Get the emails of students who gave outliers or zeros</span>
                <span class="n">emails</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">outliers</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;Email&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">email</span> <span class="ow">in</span> <span class="n">emails</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">email</span> <span class="ow">in</span> <span class="n">outliers_count</span><span class="p">:</span>
                        <span class="n">outliers_count</span><span class="p">[</span><span class="n">email</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">outliers_count</span><span class="p">[</span><span class="n">email</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Convert the dictionary into a DataFrame for better readability</span>
        <span class="n">outliers_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">outliers_count</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">,</span> <span class="s2">&quot;Outlying Grades Given&quot;</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Outlying Grades Given&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">outliers_df</span></div>


<div class="viewcode-block" id="Grader.process_form_responses">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.process_form_responses">[docs]</a>
    <span class="k">def</span> <span class="nf">process_form_responses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spreadsheet_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_data_from_spreadsheet</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">)</span>

        <span class="c1"># Calculate each group average grades</span>
        <span class="n">group_averages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_group_averages</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># Calculate student averages given for each team</span>
        <span class="n">student_averages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_student_averages</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># Get the top 3 presentations</span>
        <span class="n">top_3_presentations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_top_three_presentations</span><span class="p">(</span><span class="n">group_averages</span><span class="p">)</span>

        <span class="c1"># Get student outliers</span>
        <span class="n">student_outliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_student_outliers</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">group_averages</span><span class="p">,</span> <span class="n">student_averages</span><span class="p">,</span> <span class="n">top_3_presentations</span><span class="p">,</span> <span class="n">student_outliers</span></div>


<div class="viewcode-block" id="Grader.grade_presentation_project">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.grade_presentation_project">[docs]</a>
    <span class="k">def</span> <span class="nf">grade_presentation_project</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">form_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">assignment_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">emails</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">path_image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Grade the presentation for a group of students, this will read the scores from a Google Forms and update the grades in Canvas&quot;&quot;&quot;</span>
        <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;Grading presentation project...&quot;</span><span class="p">)</span>
        <span class="c1"># Get responses from Google Forms</span>
        <span class="n">df_responses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">get_form_responses</span><span class="p">(</span><span class="n">form_id</span><span class="p">)</span>  <span class="c1"># DataFrame</span>
        <span class="k">if</span> <span class="n">df_responses</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No responses found in the Google Form.&quot;</span><span class="p">)</span>
        <span class="n">excel_path</span> <span class="o">=</span> <span class="n">path_image</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">)</span>
        <span class="n">df_responses</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">excel_path</span><span class="p">)</span>
        <span class="c1"># fmt: off</span>
        <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Slide deck?&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Slide deck?&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Presentation skills?&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Presentation skills?&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Research topic and (summary) paper content?&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Research topic and (summary) paper content?&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="c1"># fmt: on</span>
        <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;responses = &quot;</span><span class="p">,</span> <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">])</span>
        <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1">#### PROCESSING ####</span>
        <span class="c1"># processing - removing emails that are not in the class list</span>
        <span class="n">students</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_users_in_course</span><span class="p">()</span>
        <span class="n">student_emails</span> <span class="o">=</span> <span class="p">[</span><span class="n">student</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">student</span> <span class="ow">in</span> <span class="n">students</span><span class="p">]</span>
        <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;student_emails = &quot;</span><span class="p">,</span> <span class="n">student_emails</span><span class="p">)</span>
        <span class="c1"># Remove responses from students not in the class</span>
        <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">df_responses</span> <span class="o">=</span> <span class="n">df_responses</span><span class="p">[</span><span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">student_emails</span><span class="p">)]</span>
        <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;Cleaned responses = &quot;</span><span class="p">,</span> <span class="n">df_responses</span><span class="p">)</span>
        <span class="c1"># fmt: off</span>
        <span class="c1"># Check if there are repeated emails in the responses</span>
        <span class="k">if</span> <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;There are repeated emails in the responses&quot;</span><span class="p">)</span>
            <span class="c1"># Print the repeated emails</span>
            <span class="n">Print</span><span class="p">(</span><span class="n">df_responses</span><span class="p">[</span><span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()])</span>
            <span class="c1"># Drop the repeated emails</span>
            <span class="n">df_responses</span> <span class="o">=</span> <span class="n">df_responses</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s2">&quot;Email&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Remove outliers</span>
        <span class="n">create_image</span><span class="p">(</span><span class="n">df_responses</span><span class="p">,</span> <span class="n">path_image</span><span class="p">)</span>
        <span class="n">grade</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Slide deck?&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="o">+</span> <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Presentation skills?&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="o">+</span> <span class="n">df_responses</span><span class="p">[</span><span class="s2">&quot;Overall grade to this team&#39;s Research topic and (summary) paper content?&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="c1"># fmt: on</span>
        <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;Grade:&quot;</span><span class="p">,</span> <span class="n">grade</span><span class="p">,</span> <span class="n">log_type</span><span class="o">=</span><span class="s2">&quot;INFO&quot;</span><span class="p">)</span>

        <span class="c1"># Get assignment id based on title</span>
        <span class="n">assignment_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_assignment_id_by_title</span><span class="p">(</span><span class="n">assignment_title</span><span class="p">)</span>

        <span class="c1"># Update grades in Canvas</span>
        <span class="n">emails</span> <span class="o">=</span> <span class="p">[</span><span class="n">email</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">email</span> <span class="ow">in</span> <span class="n">emails</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">student</span> <span class="ow">in</span> <span class="n">students</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">student</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">emails</span><span class="p">:</span>
                <span class="n">Print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating grade for </span><span class="si">{</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">log_type</span><span class="o">=</span><span class="s2">&quot;INFO&quot;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">update_student_grade</span><span class="p">(</span><span class="n">assignment_id</span><span class="p">,</span> <span class="n">student</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">grade</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">Print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error updating grade for </span><span class="si">{</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">log_type</span><span class="o">=</span><span class="s2">&quot;ERROR&quot;</span><span class="p">)</span>
        <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;Grading complete&quot;</span><span class="p">,</span> <span class="n">log_type</span><span class="o">=</span><span class="s2">&quot;INFO&quot;</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__read_team_info_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">raise_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TeamInfo</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">read_yml_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">team_info</span> <span class="o">=</span> <span class="n">TeamInfo</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">team_info</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">raise_error</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>

<div class="viewcode-block" id="Grader.create_multiple_canvas_pages_based_on_folder">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.create_multiple_canvas_pages_based_on_folder">[docs]</a>
    <span class="k">def</span> <span class="nf">create_multiple_canvas_pages_based_on_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">PageSchema</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create multiple Canvas pages based on a list of folder paths</span>

<span class="sd">        Args:</span>
<span class="sd">            folders (List[str]): List of folder paths containing presentation materials</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[PageSchema]: List of created Canvas page objects</span>

<span class="sd">        This function iterates through a list of folder paths and creates a Canvas page</span>
<span class="sd">        for each folder by calling create_canvas_page_based_on_folder(). Each folder</span>
<span class="sd">        should contain presentation materials like PDFs and team info.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize empty list to store created pages</span>
        <span class="n">pages</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Create Canvas page for each folder path in the input list</span>
        <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
            <span class="n">pages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">create_canvas_page_based_on_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">))</span>

        <span class="c1"># Return list of created Canvas pages</span>
        <span class="k">return</span> <span class="n">pages</span></div>


<div class="viewcode-block" id="Grader.verify_project_files">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.verify_project_files">[docs]</a>
    <span class="k">def</span> <span class="nf">verify_project_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify all required project files exist and return the absolute folder path, team info, and any errors</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path (str): Path to the project folder</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[str, TeamInfo, List[str]]: Tuple containing (absolute_path, team_info, list_of_errors)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># team_info: Union[TeamInfo, None] = None</span>

        <span class="c1"># Get absolute folder path</span>
        <span class="n">cur_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
        <span class="n">abs_folder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cur_dir</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">)</span>
        <span class="n">abs_folder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">abs_folder_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">abs_folder_path</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Folder path does not exist&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">abs_folder_path</span><span class="p">,</span> <span class="n">errors</span>

        <span class="c1"># Check required files exist</span>
        <span class="n">required_files</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;presentation.pdf&quot;</span><span class="p">:</span> <span class="s2">&quot;Presentation file is missing&quot;</span><span class="p">,</span>
            <span class="s2">&quot;paper.pdf&quot;</span><span class="p">:</span> <span class="s2">&quot;Paper file is missing&quot;</span><span class="p">,</span>
            <span class="s2">&quot;quiz.json&quot;</span><span class="p">:</span> <span class="s2">&quot;Quiz file is missing&quot;</span><span class="p">,</span>
            <span class="c1"># &quot;team_info.yml&quot;: &quot;Team info file is missing&quot;,</span>
            <span class="s2">&quot;github.txt&quot;</span><span class="p">:</span> <span class="s2">&quot;Github file is missing&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">error_msg</span> <span class="ow">in</span> <span class="n">required_files</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">abs_folder_path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

        <span class="c1"># # Try to load and verify team info if yml exists</span>
        <span class="c1"># team_info_path = os.path.join(abs_folder_path, &quot;team_info.yml&quot;)</span>
        <span class="c1"># if os.path.exists(team_info_path):</span>
        <span class="c1">#     try:</span>
        <span class="c1">#         team_info = self.__read_team_info_file(team_info_path)</span>
        <span class="c1">#     except ValidationError as e:</span>
        <span class="c1">#         error_details = []</span>
        <span class="c1">#         for err in e.errors():</span>
        <span class="c1">#             field_path = &quot; -&gt; &quot;.join(str(x) for x in err[&quot;loc&quot;])</span>
        <span class="c1">#             error_details.append(f&quot;\tField &#39;{field_path}&#39;: {err[&#39;msg&#39;]}&quot;)</span>
        <span class="c1">#         errors.append(f&quot;Invalid team_info.yml:\n&quot; + &quot;\n&quot;.join(error_details))</span>
        <span class="c1">#     except yaml.YAMLError as e:</span>
        <span class="c1">#         errors.append(f&quot;Invalid YAML syntax in team_info.yml: {str(e)}&quot;)</span>
        <span class="c1">#     except Exception as e:</span>
        <span class="c1">#         errors.append(f&quot;Unexpected error reading team_info.yml: {str(e)}&quot;)</span>

        <span class="c1"># Try to load and verify quiz if json exists</span>
        <span class="n">quiz_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">abs_folder_path</span><span class="p">,</span> <span class="s2">&quot;quiz.json&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">quiz_path</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">quiz_data</span> <span class="o">=</span> <span class="n">read_json_file</span><span class="p">(</span><span class="n">quiz_path</span><span class="p">)</span>
                <span class="c1"># Here you would validate quiz_data against your schema</span>
                <span class="c1"># For example:</span>
                <span class="n">quiz</span> <span class="o">=</span> <span class="n">QuizSchema</span><span class="p">(</span><span class="o">**</span><span class="n">quiz_data</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quiz file error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid JSON syntax in quiz.json: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">error_details</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">errors</span><span class="p">():</span>
                    <span class="n">field_path</span> <span class="o">=</span> <span class="s2">&quot; -&gt; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">err</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">])</span>
                    <span class="n">error_details</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Field &#39;</span><span class="si">{</span><span class="n">field_path</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid quiz.json format:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">error_details</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected error reading quiz.json: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">abs_folder_path</span><span class="p">,</span> <span class="n">errors</span></div>


<div class="viewcode-block" id="Grader.verify_all_projects">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.verify_all_projects">[docs]</a>
    <span class="k">def</span> <span class="nf">verify_all_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify all projects in the given folders and return verification results for all folders.</span>

<span class="sd">        Args:</span>
<span class="sd">            folders (List[str]): List of folder paths to verify</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Tuple[str,  List[str]]]: List of tuples containing</span>
<span class="sd">                (folder_path, list_of_errors) for all folders</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">verification_results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_project_files</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
            <span class="n">verification_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">verification_results</span></div>


<div class="viewcode-block" id="Grader.create_canvas_page_based_on_folder">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.create_canvas_page_based_on_folder">[docs]</a>
    <span class="k">def</span> <span class="nf">create_canvas_page_based_on_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PageSchema</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a Canvas page for a team project based on the contents of a folder.</span>

<span class="sd">        This function takes a folder path containing project materials (presentation, paper, team info),</span>
<span class="sd">        verifies all required files are present, and creates a formatted Canvas page with the team&#39;s</span>
<span class="sd">        information and uploaded materials.</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path (str): Path to the folder containing the team&#39;s project materials.</span>
<span class="sd">                             Must contain:</span>
<span class="sd">                             - presentation.pdf</span>
<span class="sd">                             - paper.pdf</span>
<span class="sd">                             - quiz.json</span>
<span class="sd">                             - github.txt</span>
<span class="sd">        Returns:</span>
<span class="sd">            PageSchema: The created Canvas page object containing the team&#39;s information and materials.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If any required files are missing or invalid, or if team_info cannot be parsed.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; grader = Grader(course_id=12345, module_title=&quot;Team Presentations&quot;)</span>
<span class="sd">            &gt;&gt;&gt; page = grader.create_canvas_page_based_on_folder(&quot;path/to/team1_folder&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Verify project files and get absolute path</span>
        <span class="n">folder_path</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_project_files</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Project verification failed:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">errors</span><span class="p">))</span>
        <span class="n">team_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
        <span class="n">team_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_student_record_sheets_to_team_info</span><span class="p">(</span><span class="n">team_name</span><span class="p">)</span>

        <span class="c1"># Upload the presentation and paper</span>
        <span class="n">presentation_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/presentation.pdf&quot;</span><span class="p">)</span>
        <span class="n">paper_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/paper.pdf&quot;</span><span class="p">)</span>
        <span class="n">github_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/github.txt&quot;</span><span class="p">)</span>
        <span class="c1"># Create a Canvas page</span>
        <span class="n">team_members_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;&lt;li&gt;</span><span class="si">{</span><span class="n">member</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">member</span><span class="o">.</span><span class="n">email</span><span class="si">}</span><span class="s2"> &lt;/li&gt;&quot;</span> <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">team_info</span><span class="o">.</span><span class="n">team_members</span><span class="p">])</span>

        <span class="n">body</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                &lt;h2 style=&quot;color: #2c3e50;&quot;&gt;Team Information&lt;/h2&gt;</span>
<span class="s2">                &lt;p&gt;&lt;strong&gt;Team Name:&lt;/strong&gt; </span><span class="si">{</span><span class="n">team_info</span><span class="o">.</span><span class="n">team_name</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">                &lt;p&gt;&lt;strong&gt;Topic:&lt;/strong&gt; </span><span class="si">{</span><span class="n">team_info</span><span class="o">.</span><span class="n">topic</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">                &lt;p&gt;&lt;strong&gt;Team Members:&lt;/strong&gt;&lt;/p&gt;</span>
<span class="s2">                &lt;ul style=&quot;list-style-type: disc; padding-left: 20px;&quot;&gt;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">team_members_html</span><span class="si">}</span>
<span class="s2">                &lt;/ul&gt;</span>
<span class="s2">                &lt;p&gt;&lt;strong&gt;Github Repo:&lt;/strong&gt; &lt;a href=&quot;</span><span class="si">{</span><span class="n">github_url</span><span class="si">}</span><span class="s2">&quot; style=&quot;color: #3498db;&quot;&gt;github&lt;/a&gt;&lt;/p&gt;</span>
<span class="s2">                &lt;p&gt;&lt;strong&gt;Presentation:&lt;/strong&gt; &lt;a href=&quot;</span><span class="si">{</span><span class="n">presentation_url</span><span class="si">}</span><span class="s2">&quot; style=&quot;color: #3498db;&quot;&gt;presentation&lt;/a&gt;&lt;/p&gt;</span>
<span class="s2">                &lt;p&gt;&lt;strong&gt;Paper:&lt;/strong&gt; &lt;a href=&quot;</span><span class="si">{</span><span class="n">paper_url</span><span class="si">}</span><span class="s2">&quot; style=&quot;color: #3498db;&quot;&gt;paper&lt;/a&gt;&lt;/p&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_page</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">team_info</span><span class="o">.</span><span class="n">team_name</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="c1"># Add the page to the module</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_module_item</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="n">team_info</span><span class="o">.</span><span class="n">team_name</span><span class="p">,</span>
            <span class="n">module_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module_id_with_presentations</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Page&quot;</span><span class="p">,</span>
            <span class="n">page_url</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">page</span></div>


<div class="viewcode-block" id="Grader.retrieve_page_structure">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.retrieve_page_structure">[docs]</a>
    <span class="k">def</span> <span class="nf">retrieve_page_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PageSchema</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_page_by_id</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></div>


<div class="viewcode-block" id="Grader.add_google_forms_and_create_quiz">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.add_google_forms_and_create_quiz">[docs]</a>
    <span class="k">def</span> <span class="nf">add_google_forms_and_create_quiz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="n">PageSchema</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">page_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_page_status</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">body</span> <span class="ow">and</span> <span class="p">(</span><span class="n">page_status</span> <span class="o">==</span> <span class="s2">&quot;Quiz and Feedback added&quot;</span> <span class="ow">or</span> <span class="n">page_status</span> <span class="o">==</span> <span class="s2">&quot;Done&quot;</span><span class="p">):</span>
            <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;Form and quiz URLs already present on the page. Skipping update.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">cur_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
        <span class="n">folder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cur_dir</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">)</span>
        <span class="n">folder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder_path</span><span class="p">),</span> <span class="s2">&quot;Folder path does not exist&quot;</span>
        <span class="n">quiz_path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/quiz.json&quot;</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">quiz_path</span><span class="p">),</span> <span class="s2">&quot;Quiz file does not exist&quot;</span>
        <span class="c1"># Verify that schema for quiz is good</span>
        <span class="n">team_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>

        <span class="c1"># Create a create a google forms for feedback to open at start time and close at end time + 20minutes</span>
        <span class="n">form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">make_copy_of_form</span><span class="p">(</span>
            <span class="s2">&quot;1XykFAgYiZgMLGq7qZTlVwwacGaA_hhMDsNqAN43M8IU&quot;</span><span class="p">,</span>  <span class="c1"># TODO: Need to create a shared form for everyone</span>
            <span class="sa">f</span><span class="s2">&quot;Feedback for </span><span class="si">{</span><span class="n">team_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">form_url</span> <span class="o">=</span> <span class="n">form</span><span class="p">[</span><span class="s2">&quot;responderUri&quot;</span><span class="p">]</span>
        <span class="n">quiz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_quiz_from_file</span><span class="p">(</span><span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/quiz.json&quot;</span><span class="p">)</span>
        <span class="n">quiz_url</span> <span class="o">=</span> <span class="n">quiz</span><span class="p">[</span><span class="s2">&quot;html_url&quot;</span><span class="p">]</span>

        <span class="c1"># Check if form and quiz already exist on the page to avoid duplicates</span>
        <span class="n">old_body</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">body</span>
        <span class="c1"># Add the google form to the page</span>
        <span class="n">body</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">old_body</span><span class="si">}</span>
<span class="s2">            &lt;p&gt;&lt;strong&gt;Feedback Form:&lt;/strong&gt; &lt;a href=&quot;</span><span class="si">{</span><span class="n">form_url</span><span class="si">}</span><span class="s2">&quot; style=&quot;color: #3498db;&quot;&gt;Feedback Form&lt;/a&gt;&lt;/p&gt;</span>
<span class="s2">            &lt;p&gt;&lt;strong&gt;Quiz:&lt;/strong&gt; &lt;a href=&quot;</span><span class="si">{</span><span class="n">quiz_url</span><span class="si">}</span><span class="s2">&quot; style=&quot;color: #3498db;&quot;&gt;Quiz&lt;/a&gt;&lt;/p&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="c1"># create canvas quiz based on the quiz file</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">update_page</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">page_id</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">),</span> <span class="n">form</span></div>


<div class="viewcode-block" id="Grader.get_page_status">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.get_page_status">[docs]</a>
    <span class="k">def</span> <span class="nf">get_page_status</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="n">PageSchema</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;Created&quot;</span><span class="p">,</span> <span class="s2">&quot;Quiz and Feedback added&quot;</span><span class="p">,</span> <span class="s2">&quot;Done&quot;</span><span class="p">,</span> <span class="s2">&quot;Evaluation Form&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Page ID is None&quot;</span><span class="p">)</span>

        <span class="n">page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_page_by_id</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">page</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Page body is None&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;Feedback Form:&quot;</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Quiz and Feedback added&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;Evaluation Form&quot;</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Evaluation Form&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;&lt;img&quot;</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Done&quot;</span>
        <span class="c1"># else</span>
        <span class="k">return</span> <span class="s2">&quot;Created&quot;</span></div>


<div class="viewcode-block" id="Grader.remove_feedback_url_and_quiz">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.remove_feedback_url_and_quiz">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_feedback_url_and_quiz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="n">PageSchema</span><span class="p">):</span>
        <span class="n">old_body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">body</span>  <span class="c1"># type: ignore</span>
        <span class="c1"># Remove the feedback form and quiz</span>
        <span class="k">if</span> <span class="s2">&quot;Feedback Form:&quot;</span> <span class="ow">in</span> <span class="n">old_body</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">old_body</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&lt;p&gt;&lt;strong&gt;Feedback Form:&lt;/strong&gt;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># It will not remove the feedback form</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">old_body</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">update_page</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">page_id</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">)</span></div>


<div class="viewcode-block" id="Grader.add_images_to_body">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.add_images_to_body">[docs]</a>
    <span class="k">def</span> <span class="nf">add_images_to_body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="n">PageSchema</span><span class="p">,</span> <span class="n">image_paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="n">old_body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">body</span>  <span class="c1"># type: ignore</span>
        <span class="c1"># Add the images to the body</span>
        <span class="k">for</span> <span class="n">image_path</span> <span class="ow">in</span> <span class="n">image_paths</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
            <span class="n">image_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">old_body</span><span class="p">:</span>  <span class="c1"># Replace the image</span>
                <span class="n">Print</span><span class="p">(</span><span class="s2">&quot;*****&quot;</span><span class="p">)</span>
                <span class="n">old_image_url</span> <span class="o">=</span> <span class="n">old_body</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">file_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">old_image_url</span> <span class="o">=</span> <span class="n">old_image_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;src=&quot;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">Print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;old_image_url = </span><span class="si">{</span><span class="n">old_image_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">old_body</span> <span class="o">=</span> <span class="n">old_body</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_image_url</span><span class="p">,</span> <span class="n">image_url</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># add image</span>
                <span class="n">old_body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;img src=&quot;</span><span class="si">{</span><span class="n">image_url</span><span class="si">}</span><span class="s1">&quot; alt=&quot;Image&quot; &gt;&#39;</span>
            <span class="c1"># add HTML comment to the body &quot;DONE&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">update_page</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">page_id</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">old_body</span><span class="p">)</span></div>


<div class="viewcode-block" id="Grader.get_pages_posted_in_module">
<a class="viewcode-back" href="../GradingAutomation.html#GradingAutomation.Grader.get_pages_posted_in_module">[docs]</a>
    <span class="k">def</span> <span class="nf">get_pages_posted_in_module</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">PageSchema</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_module_pages</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module_id_with_presentations</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></div>
</div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Sample Implementation</span>
    <span class="n">grader</span> <span class="o">=</span> <span class="n">Grader</span><span class="p">(</span><span class="n">course_id</span><span class="o">=</span><span class="mi">15319</span><span class="p">,</span> <span class="n">module_title</span><span class="o">=</span><span class="s2">&quot;Fall 2024 - Presentation&quot;</span><span class="p">)</span>
    <span class="n">grader</span><span class="o">.</span><span class="n">set_worksheet</span><span class="p">(</span><span class="s2">&quot;1tuuIobh2R4KQJBxCPR60E0EFVW_jr9_l6Aaj3lx6qaQ&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c1"># pprint.pprint(grader.worksheet.get_values())</span>
    <span class="n">student_records</span> <span class="o">=</span> <span class="n">grader</span><span class="o">.</span><span class="n">read_worksheet</span><span class="p">()</span>
    <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">student_records</span><span class="p">)</span>
    <span class="n">team_info</span> <span class="o">=</span> <span class="n">grader</span><span class="o">.</span><span class="n">convert_student_record_sheets_to_team_info</span><span class="p">(</span><span class="s2">&quot;SampleTeam&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">******  team info ****** &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">team_info</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Kevin Lopez, Jerry Wu.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>